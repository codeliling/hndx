<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>湖南行政学院学历查询认证系统</title>
  <link rel="stylesheet" href="/public/css/frame.css" />
  <style type="text/css">

    @media screen and (min-width: 1024px) and (max-width: 1366px) {
      .contentPanel{
        margin: 0 auto;
        width: 95%;
        height: auto;
      }
    }

    @media screen and  (min-width: 1366px) and (max-width: 1440px) {
      .contentPanel{
        margin: 0 auto;
        width: 80%;
        height: auto;
      }
    }

    @media screen and (min-width: 1440px) and (max-width: 1920px) {
      .contentPanel{
        margin: 0 auto;
        width: 70%;
        height: auto;
      }
    }
    .leftPanel{
      display: inline-block;
      float:left;
      width:56%;
      height:auto;
      margin-right:10px;
    }

    .rightPanel{
      display: inline-block;
      width:40%;
      height: 500px;
      margin-left:10px;
    }

    h1{
      font-weight: bold;
      font-size: 24px;
    }

    .labelTitle{
      display: block;
      font-weight: bold;
      padding-bottom: 5px;
      margin-top: 10px;
    }

    .labelResult{
      display: block;
      font-weight: bold;
      width:20em;
      height: 2.5em;
      line-height: 2.5em;
      border:1px solid #f4f4f4;
      background-color: #f4f4f4;
      border-radius: 5px;
      color:#838383;
    }
    .downloadBtn{
      width: 21em;
      height: 3em;
      background-color: #b92121;
      border:2px solid #b92121;
      border-radius: 8px;
      outline:none;
      margin-top: 10px;
      margin-left: 10px;
      font-weight: bold;
      color:white;
    }
  </style>
</head>
<body>
  <div class="top-center-bottom">
    <div class="top">
      <img class="logo" src="/public/images/logo@2x.png"/>
    </div>
    <div class="center">
      <div class="contentPanel">
        <div class="leftPanel">

            <h1 style="margin-top:15px;">电子证书查询结果</h1>
            <div style="display:inline-block">
              <label class="labelTitle">姓名</label>
              <lable class="labelResult">李灵</lable>
              <label class="labelTitle">出生日期</label>
              <lable class="labelResult"></lable>
              <label class="labelTitle">毕(结)业日期</label>
              <lable class="labelResult"></lable>
              <label class="labelTitle">学习形式</label>
              <lable class="labelResult"></lable>
            </div>
            <div style="display:inline-block;margin-left:40px;">
              <label class="labelTitle">性别</label>
              <lable class="labelResult"></lable>
              <label class="labelTitle">入学日期</label>
              <lable class="labelResult"></lable>
              <label class="labelTitle">学历类别</label>
              <lable class="labelResult"></lable>
              <label class="labelTitle">证书编号</label>
              <lable class="labelResult"></lable>
            </div>
            <p style="margin-top:20px;color:#838383;line-height:20px;">
              声明：<br/>
1、未经学历信息权属人同意，不得将本材料用于违背权属人意愿之用途。学历信息内容标注“＊”号，表示该项内容不详。学历信息如有修改，请以网站在线查询内容为准。
<br/>
2、学历证书查询结果仅供查询人使用，不具有再验证功能。如需向第三方提供学历信息，建议使用具有验证功能的学历证书电子注册备案表。
            </p>

            <div style="text-align:center">
              <input type="button" class="downloadBtn" onclick="outputImage()" value="下载保存电子学历证书" />
            </div>
        </div>
        <div id="rPanel" class="rightPanel">
          <canvas id="myCanvas" width="100%" height="auto" style="border:0px"></canvas>
        </div>

      </div>
      <div class="bottom">
        <div class="bottomLeft">
          <a href="#">网站首页</a>&nbsp&nbsp|&nbsp&nbsp<a href="#">网站后台</a>
        </div>
        <div class="bottomRight">
          <p>
            中共湖南省委党校 湖南行政学院 ©版权所有 &nbsp&nbsp 地址：湖南省长沙市岳麓区白云路386号 邮编：410006
          </p>
        </div>
      </div>
    </div>
  </div>

</body>
<script>
		(function(){
			loadCertifate();
		})();

		let name = "";
		let number = "";
		let gender = "";
		let nation = "";
		let cardNum = "";
		let certificateNumber = "";

		function clearCanvas()
		{
		    var c = document.getElementById("myCanvas");
		    var cxt = c.getContext("2d");
		    cxt.clearRect(0,0,c.width,c.height);
		}

		function loadCertifate(){
			var canvas = document.getElementById('myCanvas');
      canvas.width = document.getElementById('rPanel').offsetWidth;
		  canvas.height = document.getElementById('rPanel').offsetHeight;

			var ctx = canvas.getContext('2d');
			var myImage = new Image();

			myImage.src = '/public/images/Preview_of_record _@2x.png';
			myImage.style.cssText = "transform:scale(0.5)";

			myImage.onload = function(){
        var scale = canvas.width / myImage.width;

				ctx.drawImage(myImage,0,-70, scale*myImage.width, scale*myImage.height);

				var sealImg = new Image();
			    sealImg.onload = function(){
			      ctx.drawImage(sealImg,260,350,sealImg.width/5,sealImg.height/5);

			      ctx.font = "10px Arial";
			      ctx.fillText("2019010213123", 280, 188);
			      ctx.fillText("2019", 280, 202);
            ctx.fillText("10", 322, 202);
            ctx.fillText("3", 345, 202);

            ctx.font = "16px Arial";
            ctx.fillText("张学友", 80, 235);
            ctx.font = "10px Arial";
            ctx.fillText("4301811977010123123", 245, 235);
            ctx.fillText("2019", 70, 253);
            ctx.fillText("10", 130,253);

            ctx.fillText("2019",190, 253);
            ctx.fillText("10", 250, 253);

            ctx.fillText("经济学", 130, 275);
            ctx.fillText("32131232", 260, 275);
            ctx.fillText("3", 345, 275);

            ctx.fillText("2019", 90, 315);
            ctx.fillText("10", 150, 315);

            ctx.fillText("14301123123", 220, 337);
			    }
			    sealImg.src = '/public/images/seal.png';


			};
		}

		function IEVersion() {
            var userAgent = navigator.userAgent; //取得浏览器的userAgent字符串
            var isIE = userAgent.indexOf("compatible") > -1 && userAgent.indexOf("MSIE") > -1; //判断是否IE<11浏览器
            var isEdge = userAgent.indexOf("Edge") > -1 && !isIE; //判断是否IE的Edge浏览器
            var isIE11 = userAgent.indexOf('Trident') > -1 && userAgent.indexOf("rv:11.0") > -1;
            if(isIE) {
                var reIE = new RegExp("MSIE (\\d+\\.\\d+);");
                reIE.test(userAgent);
                var fIEVersion = parseFloat(RegExp["$1"]);
                if(fIEVersion == 7) {
                    return 7;
                } else if(fIEVersion == 8) {
                    return 8;
                } else if(fIEVersion == 9) {
                    return 9;
                } else if(fIEVersion == 10) {
                    return 10;
                } else {
                    return 6;//IE版本<=7
                }
            } else if(isEdge) {
                return 'edge';//edge
            } else if(isIE11) {
                return 11; //IE11
            }else{
                return -1;//不是ie浏览器
            }
        }

        function outputImage(){
        	if(IEVersion() == -1){
        		downLoad(saveAsPNG());
        	}
        	else{
        		var canvas = document.getElementById('myCanvas');
        		downloadURI(canvas,'你的学历.png');
        	}
        }

	    function saveAsPNG() {
	    	var canvas = document.getElementById('myCanvas');
		    return canvas.toDataURL("image/png");
		}

	    function downLoad(url){
		    var oA = document.createElement("a");
		    oA.download = name;// 设置下载的文件名，默认是'下载'
		    oA.href = url;
		    document.body.appendChild(oA);
		    oA.click();
		    oA.remove(); // 下载之后把创建的元素删除
		}


		function downloadURI(canvas, name) {
		    if (navigator.msSaveBlob) { // IE10+
		        let blob = canvas.msToBlob();
		        return navigator.msSaveBlob(blob, name);
		    } else {
		        let uri = canvas.toDataURL("image/png");
		        let link = document.createElement("a");
		        link.download = name;
		        link.href = uri;
		        document.body.appendChild(link);
		        if (link.click) {
		            link.click();
		        } else {
		            let event = document.createEvent('MouseEvents');
		            event.initMouseEvent('click', true, true, window);
		            link.dispatchEvent(event);
		        }
		        document.body.removeChild(link);
		    }
		}

	</script>
</html>
